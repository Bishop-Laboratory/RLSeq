roxygen2::roxygenise()
roxygen2::roxygenise()
library(RSeqR)
RSeqR::printHello()
RSeqR::printHello(name = "HEnry")
library(ChIPpeakAnno)
library(EnsDb.Hsapiens.v86)
library(org.Hs.eg.db)
bed <- "ERX2277510_E-MTAB-6318DRIP_mOHT_hg38.unstranded.bed"
peaks <- ChIPpeakAnno::toGRanges(filename, format = "BED", header = FALSE)
bed <- "ERX2277510_E-MTAB-6318DRIP_mOHT_hg38.unstranded.bed"
peaks <- ChIPpeakAnno::toGRanges(filename, format = "BED", header = FALSE)
annotatePeaks <- function(peaks) {
print(head(peaks))
annoData <- toGRanges(EnsDb.Hsapiens.v86)
anno <- annotatePeakInBatch(peaks, AnnotationData = annoData)
anno <- addGeneIDs(anno, orgAnn = "org.Hs.eg.db", feature_id_type = "ensembl_gene_id", IDs2Add = c("symbol"))
print(head(anno))
anno_df <- as.data.frame(anno)
print(head(anno_df))
return(res)
}
res <- annotatePeaks(peaks)
peaks <- ChIPpeakAnno::toGRanges(filename, format = "BED", header = FALSE)
peaks <- ChIPpeakAnno::toGRanges(bed, format = "BED", header = FALSE)
bed <- "R/ERX2277510_E-MTAB-6318DRIP_mOHT_hg38.unstranded.bed"
peaks <- ChIPpeakAnno::toGRanges(bed, format = "BED", header = FALSE)
res <- annotatePeaks(peaks)
annotatePeaks <- function(peaks) {
print(head(peaks))
annoData <- toGRanges(EnsDb.Hsapiens.v86)
anno <- annotatePeakInBatch(peaks, AnnotationData = annoData)
anno <- addGeneIDs(anno, orgAnn = "org.Hs.eg.db", feature_id_type = "ensembl_gene_id", IDs2Add = c("symbol"))
print(head(anno))
anno_df <- as.data.frame(anno)
print(head(anno_df))
return(anno_df)
}
annotatePeaks <- function(peaks) {
print(head(peaks))
annoData <- toGRanges(EnsDb.Hsapiens.v86)
anno <- annotatePeakInBatch(peaks, AnnotationData = annoData, output = 'overlapping', select = 'all')
anno <- addGeneIDs(anno, orgAnn = "org.Hs.eg.db", feature_id_type = "ensembl_gene_id", IDs2Add = c("symbol"))
print(head(anno))
anno_df <- as.data.frame(anno)
print(head(anno_df))
return(anno_df)
}
res <- annotatePeaks(peaks)
View(res)
res.colnames
res.columns
names(res)
names(res)[1]
names(res)[1] <- '#Seqnames'
names(res)
View(res)
names(res)
make.unique(names(res))
res['peak']
make.unique(res['peak'])
type(res['peak'])
make.unique(res['peak'])
make.unique(as.vector(res['peak']))
make.unique(res['peak'])
make.unique(c("a", "a", "a"))
make.unique(c("a", "a", "a"), sep = '_')
make.unique(res['peak'])
res['peak']
res[['peak']]
make.unique(res[['peak']])
names(res)
annotatePeaks <- function(peaks) {
print(head(peaks))
annoData <- toGRanges(EnsDb.Hsapiens.v86)
anno <- annotatePeakInBatch(peaks, AnnotationData = annoData, output = 'overlapping', select = 'all')
anno <- addGeneIDs(anno, orgAnn = "org.Hs.eg.db", feature_id_type = "ensembl_gene_id", IDs2Add = c("symbol"))
print(head(anno))
anno_df <- as.data.frame(anno)
names(res)[1] <- '#Seqnames'
res['peak'] <- make.unique(res[['peak']])
print(head(anno_df))
return(anno_df)
}
res <- annotatePeaks(peaks)
annotatePeaks <- function(peaks) {
print(head(peaks))
annoData <- toGRanges(EnsDb.Hsapiens.v86)
anno <- annotatePeakInBatch(peaks, AnnotationData = annoData, output = 'overlapping', select = 'all')
anno <- addGeneIDs(anno, orgAnn = "org.Hs.eg.db", feature_id_type = "ensembl_gene_id", IDs2Add = c("symbol"))
print(head(anno))
anno_df <- as.data.frame(anno)
names(anno_df)[1] <- '#Seqnames'
anno_df['peak'] <- make.unique(anno_df[['peak']])
print(head(anno_df))
return(anno_df)
}
annotatePeaks <- function(peaks) {
print(head(peaks))
annoData <- toGRanges(EnsDb.Hsapiens.v86)
anno <- annotatePeakInBatch(peaks, AnnotationData = annoData, output = 'overlapping', select = 'all')
anno <- addGeneIDs(anno, orgAnn = "org.Hs.eg.db", feature_id_type = "ensembl_gene_id", IDs2Add = c("symbol"))
print(head(anno))
anno_df <- as.data.frame(anno)
names(anno_df)[1] <- '#Seqnames'
anno_df['peak'] <- make.unique(anno_df[['peak']])
print(head(anno_df))
return(anno_df)
}
res <- annotatePeaks(peaks)
annotatePeaks <- function(peaks) {
print(head(peaks))
annoData <- toGRanges(EnsDb.Hsapiens.v86)
anno <- annotatePeakInBatch(peaks, AnnotationData = annoData, output = 'overlapping', select = 'all')
anno <- addGeneIDs(anno, orgAnn = "org.Hs.eg.db", feature_id_type = "ensembl_gene_id", IDs2Add = c("symbol"))
print(head(anno))
anno_df <- as.data.frame(anno)
names(anno_df)[1] <- '#Seqnames'
anno_df['peak'] <- make.unique(anno_df[['peak']], sep = '_')
print(head(anno_df))
return(anno_df)
}
type(res)
str(res)
type(res)
annotatePeaks <- function(peaks) {
annoData <- toGRanges(EnsDb.Hsapiens.v86)
anno <- annotatePeakInBatch(peaks, AnnotationData = annoData, output = 'overlapping', select = 'all')
anno <- addGeneIDs(anno, orgAnn = "org.Hs.eg.db", feature_id_type = "ensembl_gene_id", IDs2Add = c("symbol"))
anno_df <- as.data.frame(anno)
names(anno_df)[1] <- '#Seqnames'
anno_df['peak'] <- make.unique(anno_df[['peak']], sep = '_')
print(head(anno_df))
print(type(anno_df))
return(anno_df)
}
res <- annotatePeaks(peaks)
annotatePeaks <- function(peaks) {
annoData <- toGRanges(EnsDb.Hsapiens.v86)
anno <- annotatePeakInBatch(peaks, AnnotationData = annoData, output = 'overlapping', select = 'all')
anno <- addGeneIDs(anno, orgAnn = "org.Hs.eg.db", feature_id_type = "ensembl_gene_id", IDs2Add = c("symbol"))
anno_df <- as.data.frame(anno)
names(anno_df)[1] <- '#Seqnames'
anno_df['peak'] <- make.unique(anno_df[['peak']], sep = '_')
print(head(anno_df))
print(type(anno_df))
return(anno_df)
}
res <- annotatePeaks(peaks)
library(RSeqR)
install.packages('roxygen2')
annotatePeaks <- function(peaks) {
annoData <- toGRanges(EnsDb.Hsapiens.v86)
anno <- ChIPpeakAnno::annotatePeakInBatch(peaks, AnnotationData = annoData, output = 'overlapping', select = 'all')
anno <- ChIPpeakAnno::addGeneIDs(anno, orgAnn = "org.Hs.eg.db", feature_id_type = "ensembl_gene_id", IDs2Add = c("symbol"))
anno_df <- as.data.frame(anno)
names(anno_df)[1] <- '#Seqnames'
anno_df['peak'] <- make.unique(anno_df[['peak']], sep = '_')
return(anno_df)
}
res <- annotatePeaks(peaks)
View(res)
library(RSeqR)
library(RSeqR)
library(RSeqR)
library(RSeqR)
View(res)
View(res)
