## Feature enrichment test {.tabset}

Annotations were derived from a variety of sources and accessed using *RLHub* (unless custom annotations were supplied by the user). Detailed explanations of each database and type can be found [here](https://github.com/Bishop-Laboratory/RLBase-data#preliminary). The `valr` package was implemented to test the enrichment of these features within the supplied ranges for **`r object@metadata$sampleName`**. The output of these tests can be observed here:

```{r}
featRes <- rlresult(object, resultName = "featureEnrichment")
spec_now <- paste0(
  "featureEnrichment_",
  gsub(object@metadata$sampleName, pattern = " ", replacement = "_")
)
featRes %>%
  DT::datatable(
    options = list(
          dom = "Bfrtip", 
          scrollX = TRUE,
          buttons = list(
            extend  = 'collection',
            buttons = list(
              list(extend='csv', filename=spec_now),
              list(extend='excel', filename=spec_now)
            ),
            text    = 'Download'
          )
      )
  )
```

The results were then visualized with the `plotEnrichment()` function:

```{r}
plts_verdsplit <- plotEnrichment(object, onlyCase = FALSE, onlyPOS = FALSE, splitby = "verdict")
lapply(
  names(plts_verdsplit), 
  function(db) {
    knitr::knit_child(text = c(
    '### `r db`',
    '',
    'plts_verdsplit[[db]]',
    ''
  ), 
  envir = environment(),  
  quiet = TRUE)
  }
)
```


***
